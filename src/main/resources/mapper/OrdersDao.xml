<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dao.OrdersDao">
    <resultMap id="getAll" type="com.bean.Orders">
        <id column="order_id"  property="orderId" />
        <result column="CustomId"  property="customid" />
        <result column="OrderTime"  property="ordertime" />
        <result column="OrderMoney"  property="ordermoney" />
        <!--<result column="operatorId"  property="operatorid" />-->
        <result column="dStatus"  property="dstatus" />
        <!--<result column="Checkid"  property="checkid" />-->
        <result column="Chectime" property="chectime" />
        <result column="opinion"  property="opinion" />
        <result column="warehouseId"  property="warehouseid" />
        <result column="Dd_state"  property="ddState" />
        <association property="custom" javaType="Custom">
            <id column="CUSTOMID" jdbcType="INTEGER" property="customid" />
            <result column="CUSTOMNAME"  property="customname" />
            <result column="SEX"  property="sex" />
            <result column="TELEPHONE"  property="telephone" />
            <result column="COMPANY"  property="company" />
            <result column="ADDRESS"  property="address" />
            <result column="CSTATUS"  property="cstatus" />
            <result column="CREATETIME"  property="createtime" />
            <result column="CREATEID"  property="createid" />
            <result column="LEADING"  property="leading" />
            <result column="DISTRACTIME" jdbcType="VARCHAR"  property="distractime" />
            <result column="SERVICEID"  property="serviceid" />
            <result column="DISTRACT"  property="distract" />
            <result column="HOMEADDRESS"  property="homeaddress" />
        </association>
        <association property="operatorid" select="com.dao.UsersDao.getOneUser" column="operatorId"/>
        <association property="checkid" select="com.dao.UsersDao.getOneUser" column="Checkid"/>
        <association property="warehouse" javaType="Warehouse">
            <id column="ID"  property="id" />
            <result column="NAME"  property="name" />
            <result column="C_ADDRESS"  property="cAddress" />
            <result column="PROVINCE_ID"  property="provinceId" />
            <result column="USRE_ID"  property="usreId" />
            <result column="PHONE"  property="phone" />
            <result column="DETAILS"  property="details" />
            <result column="STATE"  property="state" />
            <result column="USERS_ID"  property="usersId" />
            <result column="CREATION_TIME" property="creationTime" />
            <result column="CITY_ID"  property="cityId" />
        </association>
        <association property="orderdetailsList" select="com.dao.OrderdetailsDao.getDetailsByOrderId" column="order_id"/>
    </resultMap>
    <sql id="Base_Column_List">
    order_id, CustomId, OrderTime, OrderMoney, operatorId, dStatus, Checkid, Chectime, 
    opinion, warehouseId, Dd_state
  </sql>
    <select id="getAllOrders" resultMap="getAll">
    SELECT * FROM orders  LEFT JOIN custom ON orders.CustomId = custom.CUSTOMID
    LEFT JOIN users ON orders.operatorId = users.u_id
    LEFT JOIN warehouse ON orders.warehouseId = warehouse.ID
    limit #{page},#{size}
  </select>
    <select id="countOrders" resultType="java.lang.Integer">
    SELECT count(*) FROM orders  LEFT JOIN custom ON orders.CustomId = custom.CUSTOMID
    LEFT JOIN users ON orders.operatorId = users.u_id
    LEFT JOIN warehouse ON orders.warehouseId = warehouse.ID
  </select>
    <select id="getOneOrder" resultMap="getAll">
    SELECT * FROM orders  LEFT JOIN custom ON orders.CustomId = custom.CUSTOMID
    LEFT JOIN users ON orders.operatorId = users.u_id
    LEFT JOIN warehouse ON orders.warehouseId = warehouse.ID where order_id=#{orderId}
  </select>


  <!--根据客户得到所有订单-->
  <select id="getOrdersByCustomId" resultMap="getAll">
    SELECT * FROM orders  LEFT JOIN custom ON orders.CustomId = custom.CUSTOMID
    LEFT JOIN users ON orders.operatorId = users.u_id
    LEFT JOIN warehouse ON orders.warehouseId = warehouse.ID
    where CustomId=#{customId}
  </select>


    <!--<select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
      select
      <include refid="Base_Column_List" />
      from orders
      where order_id = #{orderId,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
      delete from orders
      where order_id = #{orderId,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" keyColumn="order_id" keyProperty="orderId" parameterType="com.bean.Orders" useGeneratedKeys="true">
      insert into orders (CustomId, OrderTime, OrderMoney,
        operatorId, dStatus, Checkid,
        Chectime, opinion, warehouseId,
        Dd_state)
      values (#{customid,jdbcType=INTEGER}, #{ordertime,jdbcType=TIMESTAMP}, #{ordermoney,jdbcType=DOUBLE},
        #{operatorid,jdbcType=INTEGER}, #{dstatus,jdbcType=VARCHAR}, #{checkid,jdbcType=INTEGER},
        #{chectime,jdbcType=TIMESTAMP}, #{opinion,jdbcType=VARCHAR}, #{warehouseid,jdbcType=INTEGER},
        #{ddState,jdbcType=INTEGER})
    </insert>
    <insert id="insertSelective" keyColumn="order_id" keyProperty="orderId" parameterType="com.bean.Orders" useGeneratedKeys="true">
      insert into orders
      <trim prefix="(" suffix=")" suffixOverrides=",">
        <if test="customid != null">
          CustomId,
        </if>
        <if test="ordertime != null">
          OrderTime,
        </if>
        <if test="ordermoney != null">
          OrderMoney,
        </if>
        <if test="operatorid != null">
          operatorId,
        </if>
        <if test="dstatus != null">
          dStatus,
        </if>
        <if test="checkid != null">
          Checkid,
        </if>
        <if test="chectime != null">
          Chectime,
        </if>
        <if test="opinion != null">
          opinion,
        </if>
        <if test="warehouseid != null">
          warehouseId,
        </if>
        <if test="ddState != null">
          Dd_state,
        </if>
      </trim>
      <trim prefix="values (" suffix=")" suffixOverrides=",">
        <if test="customid != null">
          #{customid,jdbcType=INTEGER},
        </if>
        <if test="ordertime != null">
          #{ordertime,jdbcType=TIMESTAMP},
        </if>
        <if test="ordermoney != null">
          #{ordermoney,jdbcType=DOUBLE},
        </if>
        <if test="operatorid != null">
          #{operatorid,jdbcType=INTEGER},
        </if>
        <if test="dstatus != null">
          #{dstatus,jdbcType=VARCHAR},
        </if>
        <if test="checkid != null">
          #{checkid,jdbcType=INTEGER},
        </if>
        <if test="chectime != null">
          #{chectime,jdbcType=TIMESTAMP},
        </if>
        <if test="opinion != null">
          #{opinion,jdbcType=VARCHAR},
        </if>
        <if test="warehouseid != null">
          #{warehouseid,jdbcType=INTEGER},
        </if>
        <if test="ddState != null">
          #{ddState,jdbcType=INTEGER},
        </if>
      </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.bean.Orders">
      update orders
      <set>
        <if test="customid != null">
          CustomId = #{customid,jdbcType=INTEGER},
        </if>
        <if test="ordertime != null">
          OrderTime = #{ordertime,jdbcType=TIMESTAMP},
        </if>
        <if test="ordermoney != null">
          OrderMoney = #{ordermoney,jdbcType=DOUBLE},
        </if>
        <if test="operatorid != null">
          operatorId = #{operatorid,jdbcType=INTEGER},
        </if>
        <if test="dstatus != null">
          dStatus = #{dstatus,jdbcType=VARCHAR},
        </if>
        <if test="checkid != null">
          Checkid = #{checkid,jdbcType=INTEGER},
        </if>
        <if test="chectime != null">
          Chectime = #{chectime,jdbcType=TIMESTAMP},
        </if>
        <if test="opinion != null">
          opinion = #{opinion,jdbcType=VARCHAR},
        </if>
        <if test="warehouseid != null">
          warehouseId = #{warehouseid,jdbcType=INTEGER},
        </if>
        <if test="ddState != null">
          Dd_state = #{ddState,jdbcType=INTEGER},
        </if>
      </set>
      where order_id = #{orderId,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.bean.Orders">
      update orders
      set CustomId = #{customid,jdbcType=INTEGER},
        OrderTime = #{ordertime,jdbcType=TIMESTAMP},
        OrderMoney = #{ordermoney,jdbcType=DOUBLE},
        operatorId = #{operatorid,jdbcType=INTEGER},
        dStatus = #{dstatus,jdbcType=VARCHAR},
        Checkid = #{checkid,jdbcType=INTEGER},
        Chectime = #{chectime,jdbcType=TIMESTAMP},
        opinion = #{opinion,jdbcType=VARCHAR},
        warehouseId = #{warehouseid,jdbcType=INTEGER},
        Dd_state = #{ddState,jdbcType=INTEGER}
      where order_id = #{orderId,jdbcType=VARCHAR}
    </update>-->
</mapper>